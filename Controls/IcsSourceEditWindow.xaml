<Window x:Class="MiniCalendar.Controls.IcsSourceEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:MiniCalendar.Controls"
        Title="编辑日历" 
        Height="350" Width="400"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
        ResizeMode="NoResize"
        Icon="pack://application:,,,/AppIconWithBg.ico"
        WindowStyle="SingleBorderWindow">

    <Window.Resources>
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
        </Style>
    </Window.Resources>
    
    <Border Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" Padding="20">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- 标题栏 (移除) -->
            <!-- <Grid Grid.Row="0"> ... </Grid> -->
            
            <!-- 表单内容 -->
            <Grid Grid.Row="0" Margin="0,0,0,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- 名称 -->
                <Label Grid.Row="0" Grid.Column="0" Content="名称:" VerticalAlignment="Center" Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                <TextBox x:Name="NameTextBox" Grid.Row="0" Grid.Column="1" Margin="10,5"/>
                
                <!-- URL -->
                <Label Grid.Row="1" Grid.Column="0" Content="URL:" VerticalAlignment="Center" Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                <TextBox x:Name="UrlTextBox" Grid.Row="1" Grid.Column="1" Margin="10,5">
                    <TextBox.Style>
                        <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Grid>
                                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                                <ScrollViewer x:Name="PART_ContentHost"/>
                                            </Border>
                                            <TextBlock Text="webcal://" Foreground="Gray" VerticalAlignment="Center" Margin="5,0,0,0" IsHitTestVisible="False">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Grid>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TextBox.Style>
                </TextBox>
                
                <!-- 刷新间隔 -->
                <Label Grid.Row="2" Grid.Column="0" Content="刷新间隔:" VerticalAlignment="Center" Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                <ComboBox x:Name="RefreshIntervalComboBox" 
                         Grid.Row="2" Grid.Column="1" 
                         Margin="10,5">
                </ComboBox>
                
                <!-- 颜色 -->
                <Label Grid.Row="3" Grid.Column="0" Content="颜色:" VerticalAlignment="Center" Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="10,5">
                    <Rectangle x:Name="ColorPreview" Width="30" Height="20" Margin="0,0,10,0" Stroke="White" StrokeThickness="1"/>
                    <Button Content="选择颜色" 
                           Click="ChooseColorButton_Click"/>
                </StackPanel>
                
                <!-- 启用 -->
                <CheckBox x:Name="IsEnabledCheckBox" 
                         Grid.Row="4" Grid.Column="1"
                         Content="启用此日历"
                         Margin="10,10"
                         Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
            </Grid>
            
            <!-- 按钮栏 -->
            <StackPanel Grid.Row="1" 
                       Orientation="Horizontal" 
                       HorizontalAlignment="Right"
                       Margin="0,0,0,0">
                <Button Margin="5,0"
                        Content="确定"
                        Click="SaveButton_Click"/>
                <Button Margin="5,0"
                        Content="取消"
                        Click="CloseButton_Click"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>